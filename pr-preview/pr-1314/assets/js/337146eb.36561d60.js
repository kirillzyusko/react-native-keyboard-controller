"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[99530],{28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>l});var o=n(96540);const r={},i=o.createContext(r);function s(e){const t=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(i.Provider,{value:t},e.children)}},56979:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>s,metadata:()=>d,toc:()=>a});var o=n(74848),r=n(28453),i=n(69026);const s={},l="KeyboardChatScrollView",d={id:"api/components/keyboard-chat-scroll-view",title:"KeyboardChatScrollView",description:"KeyboardChatScrollView is a purpose-built component for chat application layouts. It handles keyboard appearance, interactive dismissal, and content repositioning with smooth 60/120 FPS animations \u2014 all the keyboard behaviors that chat apps need, but general-purpose components _struggle_ to deliver.",source:"@site/docs/api/components/keyboard-chat-scroll-view.mdx",sourceDirName:"api/components",slug:"/api/components/keyboard-chat-scroll-view",permalink:"/react-native-keyboard-controller/pr-preview/pr-1314/docs/next/api/components/keyboard-chat-scroll-view",draft:!1,unlisted:!1,editUrl:"https://github.com/kirillzyusko/react-native-keyboard-controller/tree/main/docs/docs/api/components/keyboard-chat-scroll-view.mdx",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"KeyboardAwareScrollView",permalink:"/react-native-keyboard-controller/pr-preview/pr-1314/docs/next/api/components/keyboard-aware-scroll-view"},next:{title:"KeyboardStickyView",permalink:"/react-native-keyboard-controller/pr-preview/pr-1314/docs/next/api/components/keyboard-sticky-view/"}},c={},a=[{value:"Props",id:"props",level:2},{value:"<code>ScrollView Props</code>",id:"scrollview-props",level:3},{value:"<code>ScrollViewComponent</code>",id:"scrollviewcomponent",level:3},{value:"<code>freeze</code>",id:"freeze",level:3},{value:"<code>inverted</code>",id:"inverted",level:3},{value:"<code>keyboardLiftBehavior</code>",id:"keyboardliftbehavior",level:3},{value:"<code>always</code>",id:"always",level:4},{value:"<code>whenAtEnd</code>",id:"whenatend",level:4},{value:"<code>persistent</code>",id:"persistent",level:4},{value:"<code>never</code>",id:"never",level:4},{value:"<code>offset</code>",id:"offset",level:3},{value:"Usage with virtualized lists",id:"usage-with-virtualized-lists",level:2},{value:"Example",id:"example",level:2},{value:"Design principles",id:"design-principles",level:2},{value:"Extending scroll range",id:"extending-scroll-range",level:3},{value:"Adjusting scroll position",id:"adjusting-scroll-position",level:3},{value:"iOS",id:"ios",level:4},{value:"Android",id:"android",level:4}];function h(e){const t={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components},{Head:n}=t;return n||function(e,t){throw new Error("Expected "+(t?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Head",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.h1,{id:"keyboardchatscrollview",children:"KeyboardChatScrollView"}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"KeyboardChatScrollView"})," is a purpose-built component for chat application layouts. It handles keyboard appearance, interactive dismissal, and content repositioning with smooth 60/120 FPS animations \u2014 all the keyboard behaviors that chat apps need, but general-purpose components ",(0,o.jsx)(t.strong,{children:(0,o.jsx)(t.em,{children:"struggle"})})," to deliver."]}),"\n","\n",(0,o.jsx)(i.A,{src:"/video/keyboard-chat-scroll-view/always.mov",width:35}),"\n",(0,o.jsx)(t.h2,{id:"props",children:"Props"}),"\n",(0,o.jsx)(t.h3,{id:"scrollview-props",children:(0,o.jsx)(t.a,{href:"https://reactnative.dev/docs/scrollview#props",children:(0,o.jsx)(t.code,{children:"ScrollView Props"})})}),"\n",(0,o.jsxs)(t.p,{children:["Inherits all ",(0,o.jsx)(t.a,{href:"https://reactnative.dev/docs/scrollview#props",children:"ScrollView Props"}),"."]}),"\n",(0,o.jsx)(t.h3,{id:"scrollviewcomponent",children:(0,o.jsx)(t.code,{children:"ScrollViewComponent"})}),"\n",(0,o.jsxs)(t.p,{children:["Custom component that will be used as a ",(0,o.jsx)(t.code,{children:"ScrollView"}),". Default is ",(0,o.jsx)(t.code,{children:"ScrollView"}),"."]}),"\n",(0,o.jsxs)(t.admonition,{title:"When to use it?",type:"tip",children:[(0,o.jsxs)(t.p,{children:["If you want to use ",(0,o.jsx)(t.code,{children:"ScrollView"})," from ",(0,o.jsx)(t.code,{children:"react-native-gesture-handler"})," you can pass it as a ",(0,o.jsx)(t.code,{children:"ScrollViewComponent"})," prop."]}),(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-tsx",children:'import { ScrollView } from "react-native-gesture-handler";\n\n<KeyboardChatScrollView ScrollViewComponent={ScrollView} />;\n'})})]}),"\n",(0,o.jsx)(t.h3,{id:"freeze",children:(0,o.jsx)(t.code,{children:"freeze"})}),"\n",(0,o.jsxs)(t.p,{children:["When ",(0,o.jsx)(t.code,{children:"true"}),", freezes all keyboard-driven layout changes. This is useful when dismissing the keyboard to show a custom input view (such as an emoji picker or bottom sheet) \u2014 it prevents the chat content from shifting while the transition happens."]}),"\n",(0,o.jsx)(t.h3,{id:"inverted",children:(0,o.jsx)(t.code,{children:"inverted"})}),"\n",(0,o.jsxs)(t.p,{children:["Set to ",(0,o.jsx)(t.code,{children:"true"})," if your list uses the ",(0,o.jsx)(t.code,{children:"inverted"})," prop (the standard pattern for chat-style lists where the newest messages appear at the bottom)."]}),"\n",(0,o.jsx)(t.h3,{id:"keyboardliftbehavior",children:(0,o.jsx)(t.code,{children:"keyboardLiftBehavior"})}),"\n",(0,o.jsxs)(t.p,{children:["Controls how the chat content responds when the keyboard appears. Defaults to ",(0,o.jsx)(t.code,{children:'"always"'}),"."]}),"\n",(0,o.jsx)(t.h4,{id:"always",children:(0,o.jsx)(t.code,{children:"always"})}),"\n",(0,o.jsxs)(t.p,{children:["Content always lifts with the keyboard, keeping the bottom messages visible ",(0,o.jsx)(t.strong,{children:"regardless"})," of the current scroll position. This is the most common chat app behavior, used by ",(0,o.jsx)(t.strong,{children:"Telegram"}),", ",(0,o.jsx)(t.strong,{children:"WhatsApp"}),", and others."]}),"\n",(0,o.jsx)(i.A,{src:"/video/keyboard-chat-scroll-view/always.mov",width:25}),"\n",(0,o.jsx)(t.h4,{id:"whenatend",children:(0,o.jsx)(t.code,{children:"whenAtEnd"})}),"\n",(0,o.jsxs)(t.p,{children:["Content lifts only when the scroll view is ",(0,o.jsx)(t.strong,{children:"at the end"})," (i.e., the last message is visible or near the bottom). If the user has scrolled up to read older messages, the keyboard won't push the content around. This matches the ",(0,o.jsx)(t.strong,{children:"ChatGPT"})," mobile app behavior."]}),"\n",(0,o.jsx)(i.A,{src:"/video/keyboard-chat-scroll-view/when-at-end.mov",width:25}),"\n",(0,o.jsx)(t.h4,{id:"persistent",children:(0,o.jsx)(t.code,{children:"persistent"})}),"\n",(0,o.jsxs)(t.p,{children:["Content lifts when the keyboard appears, but ",(0,o.jsx)(t.strong,{children:"does not drop back"})," when the keyboard hides. The scroll position stays where it was pushed to. This matches the ",(0,o.jsx)(t.strong,{children:"Claude"})," mobile app behavior."]}),"\n",(0,o.jsx)(i.A,{src:"/video/keyboard-chat-scroll-view/persistent.mp4",width:25}),"\n",(0,o.jsx)(t.h4,{id:"never",children:(0,o.jsx)(t.code,{children:"never"})}),"\n",(0,o.jsxs)(t.p,{children:["Content never moves in response to the keyboard. The keyboard simply overlaps the chat. This matches the ",(0,o.jsx)(t.strong,{children:"Perplexity"})," app behavior."]}),"\n",(0,o.jsx)(i.A,{src:"/video/keyboard-chat-scroll-view/never.mov",width:25}),"\n",(0,o.jsx)(t.h3,{id:"offset",children:(0,o.jsx)(t.code,{children:"offset"})}),"\n",(0,o.jsxs)(t.p,{children:["The distance between the bottom of the screen and the ",(0,o.jsx)(t.code,{children:"ScrollView"}),". When the keyboard appears, the ",(0,o.jsx)(t.code,{children:"ScrollView"})," will only push content by the effective distance (",(0,o.jsx)(t.code,{children:"keyboardHeight - offset"}),") instead of the full keyboard height. Defaults to ",(0,o.jsx)(t.code,{children:"0"}),"."]}),"\n",(0,o.jsxs)(t.p,{children:["This is useful when the input is not at the very bottom of the screen \u2014 for example, when the ",(0,o.jsx)(t.code,{children:"ScrollView"})," sits above a ",(0,o.jsx)(t.strong,{children:"safe area"})," inset, ",(0,o.jsx)(t.strong,{children:"bottom tabs"}),", or ",(0,o.jsx)(t.strong,{children:"any other fixed-height element"}),". In that case, set ",(0,o.jsx)(t.code,{children:"offset"})," to the height of the elements between the ",(0,o.jsx)(t.code,{children:"ScrollView"})," and the bottom of the screen."]}),"\n",(0,o.jsx)(t.h2,{id:"usage-with-virtualized-lists",children:"Usage with virtualized lists"}),"\n",(0,o.jsxs)(t.p,{children:[(0,o.jsx)(t.code,{children:"KeyboardChatScrollView"})," doesn't ship with built-in wrappers for third-party virtualized list libraries, but since all of them (",(0,o.jsx)(t.code,{children:"FlatList"}),", ",(0,o.jsx)(t.code,{children:"FlashList"}),", ",(0,o.jsx)(t.code,{children:"LegendList"}),") accept a custom scroll component, integration is straightforward."]}),"\n",(0,o.jsx)(t.p,{children:"First, create a wrapper component:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-tsx",metastring:'title="VirtualizedListScrollView.tsx"',children:'import { forwardRef } from "react";\nimport { KeyboardChatScrollView } from "react-native-keyboard-controller";\n\nimport type { ScrollViewProps } from "react-native";\n\nconst VirtualizedListScrollView = forwardRef((props: ScrollViewProps, ref) => {\n  return (\n    <KeyboardChatScrollView\n      ref={ref}\n      automaticallyAdjustContentInsets={false}\n      contentInsetAdjustmentBehavior="never"\n      {...props}\n    />\n  );\n});\n\nexport default VirtualizedListScrollView;\n'})}),"\n",(0,o.jsxs)(t.p,{children:["Then pass it to your list via ",(0,o.jsx)(t.code,{children:"renderScrollComponent"}),":"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-tsx",metastring:'title="FlashList"',children:"<FlashList\n  ref={ref}\n  data={messages}\n  keyExtractor={(item) => item.text}\n  renderItem={({ item }) => <Message {...item} />}\n  renderScrollComponent={VirtualizedListScrollView}\n/>\n"})}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-tsx",metastring:'title="FlatList/LegendList"',children:"const memoList = useCallback(\n  (props: ScrollViewProps) => <VirtualizedListScrollView {...props} />,\n  [],\n);\n\n<FlatList\n  ref={ref}\n  data={messages}\n  keyExtractor={(item) => item.text}\n  renderItem={({ item }) => <Message {...item} />}\n  renderScrollComponent={memoList}\n/>\n\n<LegendList\n  ref={ref}\n  data={messages}\n  keyExtractor={(item) => item.text}\n  renderItem={({ item }) => <Message {...item} />}\n  renderScrollComponent={memoList}\n/>\n"})}),"\n",(0,o.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,o.jsx)("div",{"data-snack-id":"@kirylziusko/c0b7f0","data-snack-platform":"ios","data-snack-preview":"true","data-snack-theme":"light",style:{overflow:"hidden",background:"#fbfcfd",border:"1px solid var(--color-border)",borderRadius:4,height:505,width:"100%"}}),"\n",(0,o.jsx)(n,{children:(0,o.jsx)("script",{src:"https://snack.expo.dev/embed.js",async:!0})}),"\n",(0,o.jsx)(t.h2,{id:"design-principles",children:"Design principles"}),"\n",(0,o.jsxs)(t.p,{children:["The key idea behind this component is that the ",(0,o.jsx)(t.code,{children:"ScrollView"})," layout ",(0,o.jsx)(t.strong,{children:"never"})," changes. Instead of adjusting the ",(0,o.jsx)(t.strong,{children:"layout"})," or the ",(0,o.jsx)(t.code,{children:"ScrollView"})," ",(0,o.jsx)(t.strong,{children:"position"}),", it changes the content position. To implement a chat interface we need to do two things: extend the scrollable range and adjust the scroll position."]}),"\n",(0,o.jsx)(t.h3,{id:"extending-scroll-range",children:"Extending scroll range"}),"\n",(0,o.jsxs)(t.p,{children:["When the keyboard appears we need to extend the scrollable range. On iOS this is achievable via ",(0,o.jsx)(t.code,{children:"contentInset"}),". On Android it's less straightforward because there is no such property."]}),"\n",(0,o.jsxs)(t.p,{children:["To bring support on Android, the ",(0,o.jsx)(t.code,{children:"ScrollView"})," is wrapped with ",(0,o.jsx)(t.a,{href:"https://github.com/kirillzyusko/react-native-keyboard-controller/blob/main/android/src/main/java/com/reactnativekeyboardcontroller/views/ClippingScrollViewDecoratorView.kt",children:(0,o.jsx)(t.code,{children:"ClippingScrollViewDecorator"})})," \u2014 a custom view built in ",(0,o.jsx)(t.code,{children:"react-native-keyboard-controller"})," that simulates ",(0,o.jsx)(t.code,{children:"contentInset"})," behavior on Android by exposing two additional properties: ",(0,o.jsx)(t.code,{children:"contentInsetBottom"})," and ",(0,o.jsx)(t.code,{children:"contentInsetTop"}),". The usage looks like:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-tsx",children:"<ClippingScrollViewDecorator contentInsetTop={0} contentInsetBottom={0}>\n  <ScrollView style={{ flex: 1 }}>{/* ...content... */}</ScrollView>\n</ClippingScrollViewDecorator>\n"})}),"\n",(0,o.jsxs)(t.p,{children:["The ",(0,o.jsx)(t.code,{children:"ClippingScrollViewDecorator"})," should wrap the ",(0,o.jsx)(t.code,{children:"ScrollView"}),". Whenever you change the ",(0,o.jsx)(t.code,{children:"contentInsetBottom"})," or ",(0,o.jsx)(t.code,{children:"contentInsetTop"})," properties, the ",(0,o.jsx)(t.code,{children:"contentInset"})," will be automatically applied to the underlying ",(0,o.jsx)(t.code,{children:"ScrollView"}),"."]}),"\n",(0,o.jsx)(t.h3,{id:"adjusting-scroll-position",children:"Adjusting scroll position"}),"\n",(0,o.jsx)(t.p,{children:"The second step is to adjust the scroll position. This is handled differently on iOS and Android."}),"\n",(0,o.jsx)(t.h4,{id:"ios",children:"iOS"}),"\n",(0,o.jsxs)(t.p,{children:["On iOS we change the ",(0,o.jsx)(t.a,{href:"https://reactnative.dev/docs/scrollview#contentoffset",children:(0,o.jsx)(t.code,{children:"contentOffset"})})," property. It works well and without bugs, unlike on Android, so for Android we use a different approach."]}),"\n",(0,o.jsx)(t.h4,{id:"android",children:"Android"}),"\n",(0,o.jsxs)(t.p,{children:["On Android we adjust the scroll position inside the ",(0,o.jsx)(t.a,{href:"../hooks/keyboard/use-keyboard-handler#onmove",children:(0,o.jsx)(t.code,{children:"onMove"})})," handler via the ",(0,o.jsx)(t.a,{href:"https://docs.swmansion.com/react-native-reanimated/docs/scroll/scrollTo/",children:(0,o.jsx)(t.code,{children:"scrollTo"})})," method on the UI thread from a worklet."]})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},69026:(e,t,n)=>{n.d(t,{A:()=>i});var o=n(86025),r=(n(96540),n(74848));function i({src:e,width:t=100,...n}){const i=(0,o.Ay)(e);return(0,r.jsx)("div",{className:"center video",children:(0,r.jsx)("video",{autoPlay:!0,loop:!0,muted:!0,playsInline:!0,height:"100%",src:i,width:`${t}%`,...n})})}}}]);