# ChatKit

`ChatKit` is a purpose-built component for chat application layouts. It handles keyboard appearance, interactive dismissal, and content repositioning with smooth 60/120 FPS animations — all the keyboard behaviors that chat apps need but general-purpose components struggle to deliver.

import Video from "@site/src/components/Video";

## Props

### [`ScrollView Props`](https://reactnative.dev/docs/scrollview#props)

Inherits all [ScrollView Props](https://reactnative.dev/docs/scrollview#props).

### `ScrollViewComponent`

Custom component that will be used as a `ScrollView`. Default is `ScrollView`.

:::tip When to use it?
If you want to use `ScrollView` from `react-native-gesture-handler` you can pass it as a `ScrollViewComponent` prop.

```tsx
import { ScrollView } from "react-native-gesture-handler";

<ChatKit.ScrollView ScrollViewComponent={ScrollView} />;
```

:::

### `freeze`

When `true`, freezes all keyboard-driven layout changes. This is useful when dismissing the keyboard to show a custom input view (such as an emoji picker or bottom sheet) — it prevents the chat content from shifting while the transition happens.

### `inverted`

Set to `true` if your list uses the `inverted` prop (the standard pattern for chat-style lists where the newest messages appear at the bottom).

:::danger Android limitation
On Android, inverted lists only support `keyboardLiftBehavior="always"`. Other modes are not available when `inverted={true}`.
:::

### `keyboardLiftBehavior`

Controls how the chat content responds when the keyboard appears. Defaults to `"always"`.

#### `always`

Content always lifts with the keyboard, keeping the bottom messages visible **regardless** of the current scroll position. This is the most common chat app behavior, used by **Telegram**, **WhatsApp**, and others.

<Video src="/video/chat-kit/always.mov" width={35} />

#### `whenAtEnd`

Content lifts only when the scroll view is **at the end** (i.e., the last message is visible or near the bottom). If the user has scrolled up to read older messages, the keyboard won't push the content around. This matches the **ChatGPT** mobile app behavior.

<Video src="/video/chat-kit/when-at-end.mov" width={35} />

#### `persistent`

Content lifts when the keyboard appears, but **does not drop back** when the keyboard hides. The scroll position stays where it was pushed to. This matches the **Claude** mobile app behavior.

#### `never`

Content never moves in response to the keyboard. The keyboard simply overlaps the chat. This matches the **Perplexity** app behavior.

<Video src="/video/chat-kit/never.mov" width={35} />

### `offset`

## Usage with virtualized lists

`ChatKit` doesn't ship with built-in wrappers for third-party virtualized list libraries, but since all of them (`FlatList`, `FlashList`, `LegendList`) accept a custom scroll component, integration is straightforward.

First, create a wrapper component:

```tsx title="VirtualizedListScrollView.tsx"
import { forwardRef } from "react";
import { ChatKit } from "react-native-keyboard-controller";

import type { ScrollViewProps } from "react-native";

const VirtualizedListScrollView = forwardRef((props: ScrollViewProps, ref) => {
  return (
    <ChatKit.ScrollView
      ref={ref}
      automaticallyAdjustContentInsets={false}
      contentInsetAdjustmentBehavior="never"
      {...props}
    />
  );
});

export default VirtualizedListScrollView;
```

Then pass it to your list via `renderScrollComponent`:

```tsx title="FlashList"
<FlashList
  ref={ref}
  data={messages}
  keyExtractor={(item) => item.text}
  renderItem={({ item }) => <Message {...item} />}
  renderScrollComponent={VirtualizedListScrollView}
/>
```

```tsx title="FlatList/LegendList"
const memoList = useCallback(
  (props: ScrollViewProps) => <VirtualizedListScrollView {...props} />,
  [],
);

<FlatList
  ref={ref}
  data={messages}
  keyExtractor={(item) => item.text}
  renderItem={({ item }) => <Message {...item} />}
  renderScrollComponent={memoList}
/>

<LegendList
  ref={ref}
  data={messages}
  keyExtractor={(item) => item.text}
  renderItem={({ item }) => <Message {...item} />}
  renderScrollComponent={memoList}
/>
```

## Example

TODO: put a snack here?

```tsx

```

## Known issues

TODO: put a real link here

- [react-native-reanimated#5567](https://github.com/software-mansion/react-native-reanimated/issues/5567): Android has undesired "bounce" animation effect on Fabric architecture
